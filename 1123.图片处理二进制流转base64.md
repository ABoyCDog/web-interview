# 二进制流文件（图片）展示

## 二进制流 转 base64 展示到 img data

```js
// html
<el-dialog>
  <!--这里注意src使用v-bind-->
  <img :src="imgUrl" alt="" />
</el-dialog>
// js
showImage(item.id).then(response => {
// response 为请求返回的二进制流 ，注意后面的data和byte是reduce的内置参数，注意分辨
  this.imgUrl =
    "data:image/png;base64," +
    btoa(
      new Uint8Array(response).reduce(
        (data, byte) => data + String.fromCharCode(byte),
        ""
      )
    )
  this.showDialog = true
}
```

## 二进制流 转 base64 展示到 打开新窗口并展示图片

```js
showImage(item.id)
	.then((response) => {
		const img = new Image();
		// 二进制流转base64
		img.src =
			"data:image/png;base64," +
			btoa(
				new Uint8Array(response).reduce(
					(data1, byte) => data1 + String.fromCharCode(byte),
					""
				)
			);
		const newwin = window.open("");
		newwin.document.write(img.outerHTML);
		newwin.document.title = item.fileName; // '流程图'
		newwin.document.close();
	})
	.catch((err) => {
		console.log(err);
	});
```

# 二进制流文件下载

## 二进制流 下载

```js
// api
export function filesDownload(id) {
  return request({
    baseURL: BASE_URL,
    url: '/download/' + id,
    responseType: 'arraybuffer',
    method: 'get'
  })
}
// js
filesEvent(items) {
      filesDownload(items.id)
        .then(response => {
          const blob = new Blob([response], {
            type: 'application/octet-stream'
          })
          if (window.navigator && window.navigator.msSaveOrOpenBlob) {
            window.navigator.msSaveOrOpenBlob(blob, items.originalName)
          } else {
            const aTag = document.createElement('a')
            aTag.download = items.originalName
            aTag.href = URL.createObjectURL(blob)
            URL.revokeObjectURL(blob)
            aTag.click()
            aTag.remove()
          }

          this.$message({
            type: 'success',
            message: '下载成功'
          })
        })
        .catch(() => {})
    }
```
